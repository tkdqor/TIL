# Operating System

📖 **Contents**

- Operating System
  - [프로세스와 스레드](#프로세스와-스레드)
  - [non-blocking call이란](#non-blocking-call이란)
  - [커널](#커널)
  - [데몬(daemon) 프로세스란](#데몬-프로세스란)


* * *

# 프로세스와 스레드
- 과거의 컴퓨터는 게임을 다운로드 하는 작업, 마우스나 키보드로부터 입력을 받는 작업, 브라우져로 사이트를 돌아다니는 작업 등 작업을 동시에 하지 못하고 한 번에 하나씩만 할 수 있었다.
- 컴퓨터가 프로세스 여러 개를 함께 돌리는 멀티태스킹이 가능해지기 전까지는 이런 현상이 일어났다고 한다.

## 프로세스
- 컴퓨터에서 실행할 수 있는 파일, 윈도우의 경우 이름 뒤쪽에 .exe가 붙어있는 그런 파일들을 **"프로그램"** 이라고 한다.
- 그리고 그 프로그램이 실행되서 돌아가고 있는 상태, 즉 컴퓨터가 어떤 일을 하고 있는 상태 / **컴퓨터에서 연속적으로 실행되고 있는 컴퓨터 프로그램을 "프로세스"** 라고 한다. **또한, 운영체제로부터 프로세서, 필요한 주소 공간, 메모리 등 자원을 할당받는 작업의 단위라고도 볼 수 있다.**
- 오늘날 우리들이 컴퓨터를 쾌적하게 사용할 수 있는 건,  
  운영체제가 여러 개의 프로세스를 함께 돌리고 있기 때문이다.
  - ex) 윈도우의 경우 작업관리자로 들어가서 컴퓨터에 얼마나 많은 프로세스들이 지금도 돌고 있는지 확인할 수 있음.
- 여러 프로세스를 함께 돌리는 작업은 -> **"동시적, 병렬적, 또는 이 둘의 혼합**으로 이루어진다.

### 동시성
- **프로세서(CPU)** 하나가 이거 조금 하고 이거 조금 하고 이런식으로 여러 작업을 돌아가면서 일부분씩 진행하는 것.
  - 이렇게 진행중인 작업을 바꾸는 것을 **"Context Switching"** 이라고 하는데 여기에는 다양한 방식과 알고리즘이 사용된다.  
    이 과정이 빨리 돌아가기 때문에 사람들에게는 이 프로세스가 마치 동시에 진행되는 것처럼 느껴지게 된다.

### 병렬성
- **프로세서 하나에(하나안에) 코어 여러개**가 달려서 코어 각각이 동시에 작업들을 수행하는 것.  
  ex) 듀얼코어, 쿼드코어, 옥타코어 등 이런 명칭이 붙는 멀티코어 프로세서가 장착된 컴퓨터에서만 할 수 있는 방식.
- CPU의 속도가 발열 등 물리적 제약 때문에 예전만큼 빠르게 발전하지 못하자, 그 대안으로 코어를 여러 개 달아서 작업을 분담할 수 있도록 만든 것이다.


## 스레드
- 컴퓨터는 현재 여러 프로세스를 함께 돌릴 수 있게 되었지만, 이걸로 충분할까?
- 브라우저도 하나의 프로그램이고 이게 돌면서 하나의 프로세스가 진행되고 있다.     
  그런데 브라우저가 일을 할 때도, 브라우저 안에서도 게임을 다운받는 동시에 다른 페이지들을 돌아다닐 수 있어야 하고 유튜브 영상의 데이터를 받아오면서 받아진 데이터로 영상을 실행할 수도 있어야 한다.   
  -> 한 프로세스 내에서도 여러 갈래의 작업들이 동시에 진행될 필요가 있는 것이다.   
  -> **즉, 프로세스 내에서 실행되는 여러 흐름의 단위를 "스레드"** 라고 부른다.

- **멀티 프로세스로 할 수 있는 작업들을 굳이 하나의 프로세스에서 스레드로 나눠서 일을 하는 이유는, 운영체제는 시스템 자원을 효율적으로 관리하기 위해서 스레드를 사용하기 때문이다. 또한, 프로세스 간의 통신보다 스레드 간의 통신 비용이 적어 작업들 간의 통신 부담이 줄어들게 된다.**

ex) 프로세서는 요리사라고 가정한다면, 대량주문이 들어오는 식당에서 끊임없이 만들어내는 요리 메뉴 하나하나가 바로 프로세스라고 할 수 있다.  
    컴퓨터는 프로세스마다 자원을 분할해서 할당하게 된다.  
    라면 끓이는 섹션, 김밥 마는 섹션, 햄버거 만드는 섹션 등 이렇게 조리 공간을 나눠서 요리사 혼자 돌아다니면서 동시적으로 하든 여럿이서 병렬적으로 하든 혹은 이 2가지 방법을 섞어서 하든 이 메뉴들을 계속해서 만들어 나가는 것이다.  
    햄버거를 만드는 프로세스에서는 패티를 굽는 스레드가 진행되는 동안, 빵에 야채를 얹고 소스를 뿌리는 스레드도 진행될 수 있을 것이다.  
    -> 이처럼 한 메뉴의 스레드들은 같은 조리대에서 진행된다. 같은 메뉴를 만들때는 같은 공간과 장비, 즉 같은 자원을 공유하는 것이 더 효율적이기 때문이다. 프로세스들은 컴퓨터의 자원을 분할해서 쓰지만, 스레드는 프로세스마다 주어진 전체 자원을 함께 사용하는 것이다.
    
이러한 방법이 속도와 효율면에서는 좋겠지만, 단점도 존재한다.  
프로세스 안에서 공유되는 변수에 스레드 2개가 동시에 손을 댄다면, 컴퓨터에서는 에러가 나게 된다.  
이렇게 시간 문제로 발생하는 이런 상황들을 예상하고 방지해야 하기 때문에 스레드를 사용하는 프로그래밍은 코드를 짜기도, 디버깅을 해서 오류를 찾아내고 원인을 밝히기도 굉장히 까다로운 경우가 많다.

- 다행히도 이런 작업들을 더 쉽고 안전하게 할 수 있는 도구들이나 프로그래밍 방식들이 오늘날의 개발자들을 많이 도와주고 있다.


### ex) Java에서 스레드 사용하는 프로그래밍
- 라면 끓이는 섹션에 버너가 4개 있다면 -> 스레드도 4개를 만들어서 라면이 최대 4개까지 동시에 끓여지도록 프로그래밍 할 수 있다. 
- https://www.youtube.com/watch?v=iks_Xb9DtTM&list=LL&index=9&t=4s 해당 영상처럼 스레드를 사용하는 코드들을 살펴보고 짜보면서 이해하고 나면, 오늘날 사용되는 동시성 프로그래밍을 보다 더 잘 활용할 수 있도록 하는 기초지식이 된다. 


* * *

## non-blocking call이란
- **non-blocking 방식은 I/O작업을 진행하는 동안 유저 프로세스의 작업을 중단시키지 않고, 유저 프로세스가 I/O를 처리하기 위해 커널에 함수를 호출하는 system call이 진행되면 커널에서 함수의 진행 상황과 상관없이 바로 결과를 반환하는 것을 의미한다.**
- 즉, 애플리케이션 실행 시 운영체제 대기 큐에 들어가지 않고 실행 여부와 관계없이 바로 응답을 보내는 경우를 의미한다. 
  - 다른말로 하면 호출된 함수가 바로 리턴해서 호출한 함수에게 제어권을 넘겨주고, 호출한 함수가 다른 일을 할 수 있는 기회를 줄 수 있다면 non-blocking 방식이다.

- **I/O란,** 입력(Input)/출력(Output)의 약자로 컴퓨터 및 주변장치에 데이터를 전송하는 프로그램, 운영 혹은 장치를 일컫는 말이다. 키보드와 마우스처럼 입력을 위한 기기, 프린터처럼 출력에만 사용되는 기기 등 다양하다.
- **커널이란,** 메모리에 상주하는 운영체제의 일부분을 의미.

- [관련 자료](https://yoonucho.github.io/review/2019/02/26/sync_async_blocking_non-blocking.html)
  - [2](https://asfirstalways.tistory.com/348)


* * *

## 커널
- https://goodmilktea.tistory.com/23


* * *

## 데몬 프로세스란
- https://blogger.pe.kr/770


