## Migrations
- 모델의 변경내역을 "데이터베이스 스키마" 로 반영시키는 효율적인 방법을 제공해준다. 
- **우리는 모델과 데이터베이스 스키마를 맞춰야 한다. 맞춰야만 우리의 모델을 사용할 수 있다.**
- 우리가 모델만 개발하고 migrations를 통해 -> 데이터베이스로 자동 반영을 할 수 있는 것이다.

- 그런데 만약, 데이터베이스 관리자가 따로 있고 관리자(DBA)가 DB를 직접 설계하고 우리가 이 DB를 사용해야 한다면, 혹은 django 이전에 이미 DB가 있어서 그 DB와 연동해야 된다면 -> 이 때는 migrations 기능을 사용할 수 없다.
  - migrations 기능은 django를 통해서 직접 데이터베이스 스키마에 히스토리를 관리하고 직접 반영도 할 수 있는 기능이다.


### Migrations 관련 명령어
- **마이그레이션 파일 생성**
  - python manage.py makemigrations <앱이름>   (앱이름을 생략하면 전체 앱에 대해서 검사를 하게 되는데 앱이름을 지정하는 걸 추천한다. 이렇게 지정을 해주면 좀 더 빠르게 동작한다.

- **지정 데이터베이스에 마이그레이션 적용**
  - python manage.py migrate <앱이름>   (위와 같이 앱이름을 생략하면 전체 앱에 대해서 지정을 하게 된다.)
  - 맨 처음 프로젝트를 만들고 난 후에 해야하는 migrate는 앱이름 없이 전체 앱들에 대해서 진행한다. django는 기본 앱들이 있는데 settings.py -> INSTALLED_APPS에 보면 기본 앱들의 종류를 알 수 있다. 이러한 기본 앱들한테도 마이그레이션 내역들이 있다. 
 또한, 각 기본 앱들한테도 모델이 있다.
     - auth 앱에게는 user 모델이 있고 sessions 앱에도 모델이 있다. 그래서 이러한 기본 앱 안에 있는 모델에 대한 마이그레이션들을 순차적으로 적용해줘야 하는 것이다.

- **마이그레이션 적용 현황 출력**
  - python manage.py showmigrations <앱이름>  (이 때, 앱이름을 쓰지 않으면 전체 앱에 대한 현황을 보여준다.)
  - X는 다 적용이 되었다는 표시이다. 만약 공백이 있으면 적용이 되어있지 않다는 의미이다.

- **지정 마이그레이션의 SQL 내역 출력**
  - python manage.py sqlmigrate <앱이름> <마이그레이션-이름>
  - 아직 수행되지 않은 마이그레이션 파일 혹은 이미 수행된 마이그레이션에 대해서도 언제든지 sql 내역을 볼 수 있다. 


### 실제 Migrations 진행 과정
- 보통 migrations를 진행하는 순서가 마이그레이션 파일 생성 -> 지정 마이그레이션의 SQL 내역 출력 -> 지정 데이터베이스에 마이그레이션 적용 / 마이그레이션 적용 현황 출력은 수시로 진행.
  - 처음에 먼저 models.py을 수정하고나서 migrations 파일 생성 명령을 내려주면, django가 만들어준다. 하지만 여기까지는 파일만 만들어진 것이고 실제 DB에 반영 및 변경이 된 것은 아니다. 그래서, 그 마이그레이션 파일이 실제로 DB에 어떤 변화를 가할것인지 그걸 SQL의 형태로 확인해봐야 한다.
  - 그래서 sql문을 확인해보고 우리가 의도한대로 sql이 잘 생성된다고 판단이 들면 migrate 명령을 통해서 실제로 적용을 하게 되는 것이다. 




     
     
