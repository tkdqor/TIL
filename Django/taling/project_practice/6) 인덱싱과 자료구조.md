## 인덱싱과 자료구조
- table_bookings 프로젝트 디렉터리 내부에 있는 models.py로 가보자. 여기서 새로운 모델을 생성하자.

```python
class Restaurant(models.Model):
    name = models.CharField(max_length=200)
    main_image = models.ForeignKey('RestaurantImage', related_name='main_image', null=True, on_delete=models.CASCADE)
    address = models.CharField(max_length=300)
    phone = models.CharField(max_length=20)
    visible = models.BooleanField(default=True)
    latitude = models.FloatField()
    longitude = models.FloatField()
    created_at = models.DateTimeField(auto_now_add=True, null=False)
    updated_at = models.DateTimeField(auto_now=True)
    menu_info = models.TextField(null=True)
    description = models.TextField(null=True)
```

- 식당과 관련된 모델을 생성한다. 여기서 main_image 필드는 RestaurantImage모델과 1:N관계로 설정.
  - visible BooleanField를 만들어서 식당이 문제가 있거나 이슈가 있어 보여주고 싶지 않을 때는 visible 필드로 끄게끔 하면 된다. 
  - 위도와 경도 필드도 생성하고, 생성일과 수정일도 자동으로 들어가도록 설정한다. 그리고 메뉴와 설명을 하기 위한 필드도 생성했다.


- **그 다음은 식당의 이미지 모델도 생성해주자.**

```python
class RestaurantImage(models.Model):
    restaurant = models.ForeignKey(
        Restaurant, on_delete=models.CASCADE
    )
    image = models.ImageField()
    created_at = models.DateTimeField(auto_now_add=True, null=False)
```

- **여기서 restaurant 필드에 또 1:N관계를 설정했는데, 원래 N의 모델에만 하는 게 아닌가? 해당 내용 물어보기**
  - image 필드도 넣어주고 생성일도 넣어주기.


- **그 다음은 식당의 테이블 모델을 생성한다.** 이 모델은 예약가능한 테이블 자릿수라던가 그런걸 정의하는 모델이 될 것이다.

```python
from django.utils.translation import gettext_lazy as _
...

class RestaurantTable(models.Model):
    restaurant = models.ForeignKey(
        Restaurant, on_delete=models.CASCADE
    )

    class Weekday(models.TextChoices):
        MONDAY = 'MON', _('월요일')
        TUESDAY = 'TUE', _('화요일')
        WEDNESDAY = 'WEB', _('수요일')
        THURSDAY = 'THU', _('목요일')
        FRIDAY = 'FRI', _('금요일')
        SATURDAY = 'SAT', _('토요일')
        SUNDAY = 'SUN', _('일요일')
    
    weekday = models.CharField(max_length=3, choices=Weekday.choices, default=Weekday.MONDAY)
    time = models.TimeField()
    availalbe = models.IntegerField()
    price = models.DecimalField(max_digits=12, decimal_places=2)
    created_at = models.DateTimeField(auto_now_add=True, null=False)
```

- **여기서도 restaurant 필드에 또 1:N관계를 설정했으니 물어보기**
  - **그리고 Weekday라는 클래스를 정의해놓고 weekday 필드를 만들어서 선택할 수 있게끔 설정**
  - time 필드는 날짜는 없고 시간만 기록되는 필드로 설정.
  - 예약가능한 자릿수는 availalbe = models.IntegerField() 이렇게 정수 필드로 설정.
  - **그리고 이 예약의 가격은 DecimalField 이걸로 설정해주는 게 좋다. 자릿수를 직접 정해줄 수도 있다. 그리고 소수점 둘째자리 이렇게도 설정할 수가 있다. 이렇게 하는 이유는, 우리가 한국의 경우 원 단위가 소수점이 없는데 미국같은 경우에는 달러로 계산하게 되면 소수점 둘째자리 까지는 구현이 되어야하기 때문에, 다국어를 생각했을 때는 이렇게 DecimalField를 쓰는 경우가 많다.**
    - 만약 우리가 달러를 지원하는 게 아니라 원화만 지원하거나 소수점 아래로 내려갈 필요가 없다면 decimal_places 속성을 0으로 두면 된다.

- **그 다음에는 class Meta를 설정한다. 이걸 설정하는 이유는 unique 속성을 주고 싶기 때문인데, 1개의 레스토랑에 대해서 --> 특정 요일에 대해, 특정 시간에 대해서는 중복되는 데이터가 발생하지 않도록 unique를 걸고 싶은 것이다.** ex) 어떤 레스토랑을 예약할 때, 월화수목금토일 시간표가 있다고 한다면 그 시간표에 10시 5자리 받겠다라는 표식은 데이터가 고유하게 딱 1개씩만 있어야 한다. **그래서 우리가 구현하는 레스토랑 테이블은 요일 & 레스토랑 & 시간 이 3가지 조합에 대해서는 unique하게 만들어야 된다.**
  - 이걸 구현하기 위해 모델 클래스 내부에 Meta라는 class를 선언하고 

```python
from django.utils.translation import gettext_lazy as _
...

class RestaurantTable(models.Model):
    restaurant = models.ForeignKey(
        Restaurant, on_delete=models.CASCADE
    )

    class Weekday(models.TextChoices):
        MONDAY = 'MON', _('월요일')
        TUESDAY = 'TUE', _('화요일')
        WEDNESDAY = 'WEB', _('수요일')
        THURSDAY = 'THU', _('목요일')
        FRIDAY = 'FRI', _('금요일')
        SATURDAY = 'SAT', _('토요일')
        SUNDAY = 'SUN', _('일요일')
    
    weekday = models.CharField(max_length=3, choices=Weekday.choices, default=Weekday.MONDAY)
    time = models.TimeField()
    availalbe = models.IntegerField()
    price = models.DecimalField(max_digits=12, decimal_places=2)
    created_at = models.DateTimeField(auto_now_add=True, null=False)
    
    class Meta:
        unique_together = ['restaurant', 'weekday', 'time']
```


- **위와같이 unique_together라는 리스트를 선언하고 그 안에 위에서 선언한 필드명을 넘겨주면 된다. 이렇게 하면 unique가 여러 키에 걸쳐서 선언될 수 있다.**

- 여기까지 모델링을 구성하고 makemigrations / migrate를 해준다. 그래서 지금까지 식당과 관련된 모델들을 정리해볼 수 있었다.


